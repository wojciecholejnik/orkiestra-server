<app-modal-wrapper *ngIf="selectedEvent">
    <div class="action-modal">

        <h2>{{selectedEvent.title}}</h2>
        <div class="wrapper">
            <div class="control">
                <div class="control-label">
                    <p>Data:</p>
                </div>
                <div class="control-value">
                    {{selectedEvent.dateFrom | date:'dd.MM.YYYY'}}
                    <ng-container *ngIf="selectedEvent.dateTo">
                        {{' - '}}
                        {{selectedEvent.dateTo | date:'dd.MM.YYYY'}}
                    </ng-container>
                </div>
            </div>
            
            <div class="control">
                <div class="control-label">
                    <p>Adres:</p>
                </div>
                <div class="control-value">
                    <textarea cols="2" disabled>{{selectedEvent.address}}</textarea>
                </div>
            </div>

            <div class="control">
                <div class="control-label">
                    <p>Opis:</p>
                </div>
                <div class="control-value">
                    <textarea class="description" disabled [value]="selectedEvent.description"></textarea>
                </div>
            </div>

            <div class="control">
                <div class="control-label">
                    <p>Mój status:</p>
                </div>
                    <ng-container *ngIf="isFromFuture(selectedEvent.dateFrom)">
                        <div class=" control-value external-members toggleMyStatus">
                            <div class="member">
                                <p>{{renderMyStatus()}}</p>
                            </div>
                            <div class="member">
                                <button 
                                    [disabled]="changeStatusPending"
                                    class="btn btn-sm btn-primary"
                                    (click)="changeMyStatus()"
                                >
                                    {{changeStatusPending ? 'zapisywanie' : 'Zmień'}}</button>
                            </div>
                        </div> 
                    </ng-container>
                    <ng-container *ngIf="!isFromFuture(selectedEvent.dateFrom)">
                        <div class="control-value external-members">
                            <div class="member" >
                                <p>{{renderMyStatus()}}</p>
                            </div>
                        </div>
                    </ng-container>
            </div>

            <div class="control">
                <div class="control-label pointer" (click)="toggleMembersOpen()">
                    <p>Członkowie:</p> 
                    <i *ngIf="selectedEvent.members.length > 0" class="bi" [class.bi-chevron-up]="membersOpen" [class.bi-chevron-down]="!membersOpen"></i>
                </div>
                <div class="control-value external-members pointer" (click)="toggleMembersOpen()">
                    <ng-container *ngIf="!membersOpen">
                        <div class="member" >
                            <p>{{selectedEvent.members.length}}</p>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="membersOpen">
                        <div class="member" *ngFor="let member of selectedEvent.members" >
                            <p>{{member.firstName + ' ' + member.lastName}}</p>
                        </div>
                    </ng-container>
                </div>
            </div>

            <div class="control">
                <div class="control-label pointer" (click)="toggleExternalMembersOpen()">
                    <p>Dadatkowo:</p>
                    <i *ngIf="selectedEvent.externalMembers.length > 0" class="bi" [class.bi-chevron-up]="externalMembersOpen" [class.bi-chevron-down]="!externalMembersOpen"></i>
                </div>
                <div class="control-value external-members pointer" >
                    <ng-container *ngIf="!externalMembersOpen">
                        <div class="member" (click)="toggleExternalMembersOpen()">
                            <p>{{selectedEvent.externalMembers.length}}</p>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="externalMembersOpen">
                        <div class="external-member" *ngFor="let externalMember of selectedEvent.externalMembers" (click)="toggleExternalMembersOpen()">
                            <p>{{externalMember.name}}</p>
                            <p>{{externalMember.instrument}}</p>
                            <p>{{'tel: ' + (externalMember.phone ? externalMember.phone : '---')}}</p>
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>

        <div class="buttons-wrapper" [class.middle]="!userCanChange()">
            <button *ngIf="userCanChange()" class="btn btn-primary" (click)="edit()">Edytuj</button>
            <button class="btn btn-secondary" (click)="closeModal()">Zamknij</button>
        </div>
    </div>
</app-modal-wrapper>